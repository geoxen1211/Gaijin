window.localStorage||(window.localStorage={getItem:function(a){return a&&this.hasOwnProperty(a)?decodeURIComponent(document.cookie.replace(new RegExp("(?:^|.*;\\s*)"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"),"$1")):null},key:function(a){return decodeURIComponent(document.cookie.replace(/\s*\=(?:.(?!;))*$/,"").split(/\s*\=(?:[^;](?!;))*[^;]?;\s*/)[a])},setItem:function(a,b){a&&(document.cookie=encodeURIComponent(a)+"="+encodeURIComponent(b)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/",this.length=document.cookie.match(/\=/g).length)},length:0,removeItem:function(a){a&&this.hasOwnProperty(a)&&(document.cookie=encodeURIComponent(a)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/",this.length--)},hasOwnProperty:function(a){return new RegExp("(?:^|;\\s*)"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)}},window.localStorage.length=(document.cookie.match(/\=/g)||window.localStorage).length);var docCookies={getItem:function(a){return a?decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null:null},setItem:function(a,b,c,d,e,f){if(!a||/^(?:expires|max\-age|path|domain|secure)$/i.test(a))return!1;var g="";if(c)switch(c.constructor){case Number:g=c===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+c;break;case String:g="; expires="+c;break;case Date:g="; expires="+c.toUTCString()}return document.cookie=encodeURIComponent(a)+"="+encodeURIComponent(b)+g+(e?"; domain="+e:"")+(d?"; path="+d:"")+(f?"; secure":""),!0},removeItem:function(a,b,c){return!!this.hasItem(a)&&(document.cookie=encodeURIComponent(a)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(c?"; domain="+c:"")+(b?"; path="+b:""),!0)},hasItem:function(a){return!!a&&new RegExp("(?:^|;\\s*)"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){for(var a=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),b=a.length,c=0;c<b;c++)a[c]=decodeURIComponent(a[c]);return a}};!function(a){var b,c,d={callIframe:function(a,b,c){c=c||"gaijin-menu-iframe";var d,e=document.getElementById(c);e?(e.setAttribute("src",a),d=!0):(e=document.createElement("iframe"),e.setAttribute("src",a),e.style.width="1px",e.style.height="1px",e.style.top="-100px",e.style.position="absolute",e.id=c,e.name=c),e.addEventListener("load",function(a){b(e.contentWindow)}.bind(this)),d||document.body.appendChild(e)},redrawPanel:function(a,b){requirejs.undef("menu"),b.innerHTML=a,requirejs(["menu"],function(a){})},loadCss:function(a){var b=document.createElement("link");b.type="text/css",b.rel="stylesheet",b.href=a,document.getElementsByTagName("head")[0].appendChild(b)},getOptions:function(a,b){var c,d,e,f={},g=a.length;for(c=0;c<g;c++)d=a[c],null!==(e=b.getAttribute("data-"+d))&&""!==e&&(f[d]=e);return f},extend:function(){var a,b,c,d=Array.prototype.slice.call(arguments),e=d[0]||{},f=d.length;for(a=1;a<f;a++){b=d[a];for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&void 0!==b[c]&&(e[c]=b[c])}return e},getDomain:function(a){return a.toString().replace(/http[s]?:\/\/([^/]+).*/i,"$1")},correctLang:function(a){switch(a.toString()){case"cz":return"cs";case"jp":return"ja"}return a},isExceptedLang:function(a){return"cs"==a||"ja"==a}};a.Gaijin=a.Gaijin||{};var e=document.getElementById("gm-loader"),f="";void 0!==e&&(f=e.getAttribute("src").match(/https?:\/\/[^\/]+/)),f||(f=location.href.match(/https?:\/\/[^\/]+/)),a.Gaijin.Menu={version:16,ssoUrl:f,options:{"balance-gjn":"","i18n-crt-language":"","i18n-spt-languages":"en,de,fr,cs,pl,es,it,ja,ko,pt,ru,tr,zh","prt-origin-url":"","prt-name":"","prt-lang-url":"","prt-lang-additional-url":"","prt-reg-url":"","prt-logout-url":"","sso-return":"","sso-crc":"","sso-key":"","sso-refresh":0,"sso-nick":"","sso-id":"","sso-sid":"","sso-data-change":"","additional-links":"","hide-login":!1,"hide-reg":!1,"hide-profile":!1,"hide-profile-menu":!1,autologin:!1,"go-link":"","show-lang-selector":!0,"sso-sid-key":"","sso-sid-crc":"","menu-label":0,service_jwt:""},logout:function(a,b){a.href&&(c=a.href)},concatParam:function(a,b,c){return c&&(a+=b+"="+c),a},init:function(){var g=document.getElementById("gaijin-menu"),h=Object.keys(this.options);this.options=d.extend(this.options,d.getOptions(h,e)),this.options["i18n-spt-languages"]=this.options["i18n-spt-languages"].split(",");var i=1==this.options["menu-label"]?"site":"language";try{this.options["additional-links"]=JSON.parse(this.options["additional-links"])}catch(a){this.options["additional-links"]=""}this.options["go-link"]||(this.options["go-link"]="//store.gaijin.net/");var j=this.options["sso-nick"]&&this.options["sso-id"],k=j,l="ru"==this.options["i18n-crt-language"]?"ru":"en";this.options["prt-reg-url"]||(this.options["prt-reg-url"]=this.ssoUrl+"/"+l+"/profile/register");var m,n,o=d.correctLang(this.options["i18n-crt-language"]),p=docCookies.getItem("mnm_key");if(this.options["prt-origin-url"]&&this.options["sso-return"]&&this.options["sso-crc"]&&this.options["sso-key"]){var q=d.getDomain(this.options["prt-origin-url"]),r="?return_url="+this.options["sso-return"]+"&crc="+this.options["sso-crc"]+"&public_key="+this.options["sso-key"]+"&domain="+q;this.options.service_jwt&&(r+="&service_jwt="+this.options.service_jwt),m=this.ssoUrl+"/"+l+"/sso/login"+r,n=this.options["prt-logout-url"]?this.options["prt-logout-url"]:this.ssoUrl+"/"+l+"/sso/logout"+r,this.options["sso-refresh"]&&(m+="&refresh_token=1"),p&&(m+="&mnm_key="+p)}var s='<nav class="top-panel gaijin-menu {{#isWarning}}top-panel_warning{{/isWarning}} {{#isCritical}}top-panel_critical{{/isCritical}}"><ul class="top-panel__nav-list">{{#viewLangSelector}}<li class="top-panel__item language-selector"><a class="top-panel__link top-panel__link--caret" href="#"><span class="flag '+o+'"></span> {{l10n.'+i+'}}</a><div class="top-panel__drop-list"><ul class="top-panel__inner-list">{{#languages}}<li class="top-panel__inner-list__item lang__link_inner-list"><a class="lang__link_inner-list" href="{{lang_url}}{{.}}{{lang_additional_url}}"><span class="flag {{l10n_language_code}}"></span> {{ l10n_language }}</a></li>{{/languages}}</ul></div></li>{{/viewLangSelector}}<li class="top-panel__item"><a class="top-panel__gaijin-logo" href="{{l10n.gaijin_link}}"></a></li>{{^hide_profile}}<li class="top-panel__item {{^isAuth}}top-panel__item--long{{/isAuth}}">{{#isAuth}}{{#hide_profile_menu}}<span class="top-panel__login">{{user_name}}</span>{{/hide_profile_menu}}{{^hide_profile_menu}}<a class="top-panel__link top-panel__link--caret" href="#">{{user_name}}</a><div class="top-panel__drop-list "><ul class="top-panel__inner-list "><li class="top-panel__inner-list__item"><a class="top-panel__inner-list__link" href="{{l10n_profile_link}}">{{l10n.profileBtn}}</a></li><hr><li class="top-panel__inner-list__item"><a class="top-panel__inner-list__link" href="{{login_link}}">{{l10n.changeAccount}}</a></li><hr><li class="top-panel__inner-list__item"><a class="top-panel__inner-list__link" href="{{logout_link}}" onclick="return Gaijin.Menu.logout(this,\''+this.options["sso-sid"]+'\');">{{l10n.logoutBtn}}</a></li></ul>{{/hide_profile_menu}}</div>{{/isAuth}}{{^isAuth}}{{^hide_login}}<a class="top-panel__link" href="{{login_link}}">{{l10n.loginBtn}}</a>{{#hide_reg}}<span class="top-panel__text">&nbsp;</span>{{/hide_reg}}{{^hide_reg}}<span class="top-panel__text">{{l10n.or}}</span>{{/hide_reg}}{{/hide_login}}{{^hide_reg}}<a class="top-panel__link{{#hide_login}} pad{{/hide_login}}" href="{{register_link}}">{{l10n.registerBtn}}</a>{{/hide_reg}}{{/isAuth}}</li>{{/hide_profile}}{{#isAuth}} {{{balance}}} {{/isAuth}}<li class="top-panel__item"><a class="top-panel__link store" href="{{l10n_go_url}}{{project}}">{{l10n.store}}</a></li><li class="top-panel__item"><a class="top-panel__link top-panel__link--caret" href="#">{{l10n.games}}</a><div class="top-panel__drop-list top-panel__inner-list--right-orientation"><div class="top-panel__games-list js-games-list"><div class="top-panel__game-item top-panel__game-item--big"><a href="{{l10n.wt_url}}"><div class="top-panel__game-img top-panel__game-img--wt"></div><div class="game-img__shadow"></div><div class="top-panel__game-title">War Thunder</div> </a> </div><div class="top-panel__game-item top-panel__game-item--big"><a href="{{l10n.sc_url}}"><div class="top-panel__game-img top-panel__game-img--sc"></div><div class="game-img__shadow"></div><div class="top-panel__game-title">Star Conflict</div></a> </div><div class="top-panel__game-item top-panel__game-item--big"><a href="{{l10n.xo_url}}"><div class="top-panel__game-img top-panel__game-img--xo"></div><div class="game-img__shadow"></div><div class="top-panel__game-title">Crossout</div></a></div><div class="top-panel__game-item top-panel__game-item--big"><a href="{{l10n.enl_url}}"><div class="top-panel__game-img top-panel__game-img--enl"></div><div class="game-img__shadow"></div><div class="top-panel__game-title">Enlisted</div></a></div><div class="top-panel__game-item top-panel__game-item--big"><a href="{{l10n.cr_url}}"><div class="top-panel__game-img top-panel__game-img--cr"></div><div class="game-img__shadow"></div><div class="top-panel__game-title">CRSED: F.O.A.D.</div></a></div></div><ul class="top-panel__inner-list  top-panel__inner-list--inlined"><li class="top-panel__inner-list__item"><a class="top-panel__inner-list__link" href="{{l10n.forum_wt_url}}">{{l10n.forum}}</a></li><li class="top-panel__inner-list__item"><a class="top-panel__inner-list__link" href="{{l10n.forum_sc_url}}">{{l10n.forum}}</a></li><li class="top-panel__inner-list__item"><a class="top-panel__inner-list__link" href="{{l10n.forum_xo_url}}">{{l10n.forum}}</a></li><hr class="hr"/><li class="top-panel__inner-list__item"><a class="top-panel__inner-list__link" href="{{l10n.wiki_wt_url}}">Wiki</a></li><li class="top-panel__inner-list__item"><a class="top-panel__inner-list__link" href="{{l10n.wiki_sc_url}}">Wiki</a></li><hr class="hr"/><li class="top-panel__inner-list__item"><a class="top-panel__inner-list__link" href="{{l10n.live_url}}">Live</a></li></ul></div></li><li class="top-panel__item"><a class="top-panel__link top-panel__link--caret" href="#">{{l10n.support}}</a><div class="top-panel__drop-list "><ul class="top-panel__inner-list "><li class="top-panel__inner-list__item"><a class="top-panel__inner-list__link" href="{{l10n.support_url}}">{{l10n.supportSite}}</a></li><hr /><li class="top-panel__inner-list__item"><a class="top-panel__inner-list__link" href="{{l10n.support_url}}/requests">{{l10n.help}}</a></li></ul></div></li>{{#additionalLinks}}{{{additional}}}{{/additionalLinks}}</ul>{{#isWarning}}<div class="top-panel__notification top-panel__warning">{{l10n.warning}} <a href="'+f+"/profile/subscriptions/index/"+this.options["sso-id"]+'" target="_blank" class="settings_manage">[{{l10n.settingsText}}]</a></div>{{/isWarning}}{{#isCritical}}<div class="top-panel__notification top-panel__critical">{{l10n.critical}} <a href="'+f+"/profile/subscriptions/index/"+this.options["sso-id"]+'" target="_blank" class="settings_manage">[{{l10n.settingsText}}]</a></div>{{/isCritical}}</nav>';requirejs.config({baseUrl:this.ssoUrl+"/gm/js",paths:{app:"../loader"},config:{i18n:{locale:o}},urlArgs:"v="+this.version}),d.loadCss(this.ssoUrl+"/gm/css/menu.css");var t=function(a,e){requirejs(["mustache.min"],function(f){var h="&category=";switch(window.parent.location.hostname.valueOf()){case"warthunder.ru":case"warthunder.com":case"warthunder.pro":h+="WarThunder";break;case"star-conflict.com":h+="StarConflict";break;case"crossout.net":h+="Crossout";break;case"enlisted.net":h+="Enlisted";break;case"crsed.net":h+="Crsed"}var i={balance:function(){var a=this.options["go-link"]+"balance.php",b=this.options["balance-gjn"];return!!b&&("0"===b&&(b="0.00"),'<li class="top-panel__item"><a class="top-panel__link balance" href="'+a+'">'+b+" GJN</a></li>")}.bind(this),project:h,viewLangSelector:+this.options["show-lang-selector"],l10n:a,isAuth:k,isWarning:!1,isCritical:!1,logout_link:n,login_link:m,register_link:this.options["prt-reg-url"],lang_url:this.options["prt-lang-url"],lang_additional_url:this.options["prt-lang-additional-url"],user_name:this.options["sso-nick"],hide_login:this.options["hide-login"],hide_reg:this.options["hide-reg"],hide_profile:this.options["hide-profile"],hide_profile_menu:this.options["hide-profile-menu"],language:o,languages:this.options["i18n-spt-languages"],l10n_profile_link:function(){var b=a.profile_link;return new RegExp("/^///").test(b)||(b=this.options["go-link"]+b),b}.bind(this),l10n_go_url:function(){var b=a.go_url;return new RegExp("/^///").test(b)||(b=this.options["go-link"]+b),b}.bind(this),l10n_language:function(){return a[d.correctLang(this)]},l10n_language_code:function(){return d.correctLang(this)},additionalLinks:this.options["additional-links"],additional:function(){if(this.childs){var a='<li class="top-panel__item"><a class="top-panel__link top-panel__link--caret'+(this.class?" "+this.class:"")+'" href="'+this.url+'">'+this.title+"</a>";a+='<div class="top-panel__drop-list"><ul class="top-panel__inner-list">';for(var b in this.childs){var c=this.childs[b];a+='<li class="top-panel__inner-list__item'+(c.class?" "+c.class:"")+'"><a class="top-panel__inner-list__link" href="'+c.url+'">'+c.title+"</a></li>",this.childs.length!=+b+1&&(a+='<hr class="hr" />')}return a+="</ul></div></li>"}return'<li class="top-panel__item'+(this.class?" "+this.class:"")+'"><a class="top-panel__link" href="'+this.url+'">'+this.title+"</a></li>"}};if(e)d.redrawPanel(f.render(s,i),g);else{window.addEventListener("message",function(a){function b(a){k.classList.add("menu_height-"+a),h.classList.add("menu_margin-"+a)}if(this.options["hide-profile"])d.redrawPanel(f.render(s,i),g);else if(a.origin&&-1!==a.origin.indexOf(this.ssoUrl)&&"string"==typeof a.data){var e=JSON.parse(a.data);if(void 0!==e.action)try{switch(e.action){case"isAuth":+this.options.autologin&&1!=+docCookies.getItem("user_logout")&&(3==e.data.status?location.href=m+"&autologin=1":2==e.data.status?(i.isAuth=!1,i.user_name="",j&&(location.href=n)):1==e.data.status?j?(this.options["sso-id"]!==e.data["sso-id"]&&this.options["sso-nick"]!==e.data["sso-nick"]&&(location.href=m+"&autologin=1"),!1===e.data["sso-subscriptions"].general&&(i.isWarning=!0),!1===e.data["sso-subscriptions"].notifications&&(i.isCritical=!0)):j||(location.href=m+"&autologin=1"):0==e.data.status&&j&&(location.href=n));break;case"logout":c&&(location.href=n)}}catch(a){}finally{d.redrawPanel(f.render(s,i),g);var h=document.querySelectorAll(".menu__list")[0];if(null!=h){var k=document.querySelectorAll(".menu")[0];null!=k&&(!0===i.isWarning&&!0===i.isCritical?b(2):!0===i.isWarning&&!1===i.isCritical?b(1):!1===i.isWarning&&!0===i.isCritical&&b(1))}}}}.bind(this),!1);var l=this.ssoUrl+"/api/auth/menu/?origin="+location.origin;l=this.concatParam(l,"&sid",this.options["sso-sid"]),l=this.concatParam(l,"&id",this.options["sso-id"]),l=this.concatParam(l,"&key",this.options["sso-key"]),l=this.concatParam(l,"&mnm_key",p),l=this.concatParam(l,"&sid_key",this.options["sso-sid-key"]),l=this.concatParam(l,"&sid_crc",this.options["sso-sid-crc"]),l=this.concatParam(l,"&data_change",this.options["sso-data-change"]),d.callIframe(l,function(a){b=a}.bind(this))}}.bind(this))}.bind(this),u=function(a,b){"undefined"==typeof jQuery?requirejs(["jquery-1.11.0.min"],function(c){c.noConflict(!0),t(a,b)}):t(a,b)}.bind(this);-1!=a.Gaijin.Menu.options["i18n-spt-languages"].indexOf(o)||d.isExceptedLang(o)||(o="en"),define(["nls/"+o+"/menu"],function(a){u(a,!1)}.bind(this))}},a.Gaijin.Menu.init()}(window);